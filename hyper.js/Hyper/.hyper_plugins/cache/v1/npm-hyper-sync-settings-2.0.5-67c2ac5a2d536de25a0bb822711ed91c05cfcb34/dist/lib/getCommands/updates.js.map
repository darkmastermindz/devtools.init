{"version":3,"sources":["../../../src/lib/getCommands/updates.js"],"names":["gitDateToISOString","gitDate","repoPromise","local","remote","paths","dirs","repo","fetch","checkout","log","err","hash","latest","date","then","resolve","isAfter"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AAEA,MAAMA,qBAAqBC,WAAW,sBAAOA,OAAP,EAAgB,uBAAhB,CAAtC;;;6CAEe,WAAO,EAAEC,WAAF,EAAP,EAA2B;AACxC,UAAMC,QAAQ,EAAd;AACA,UAAMC,SAAS,EAAf;;AAEA,UAAMF,WAAN;AACA,UAAM,sBACJ;AAAA,aACE,yBAAUG,iBAAMC,IAAN,CAAWC,IAArB,EACGC,KADH,GAEGC,QAFH,CAEY,eAFZ,EAGGC,GAHH,CAGO,CAAC,IAAD,EAAO,GAAP,EAAY,YAAZ,CAHP,EAGkC,UAACC,GAAD,EAAMD,GAAN,EAAc;AAC5CN,eAAOQ,IAAP,GAAcF,IAAIG,MAAJ,CAAWD,IAAzB;AACAR,eAAOU,IAAP,GAAcd,mBAAmBU,IAAIG,MAAJ,CAAWC,IAA9B,CAAd;AACD,OANH,EAOGL,QAPH,CAOY,QAPZ,EAQGC,GARH,CAQO,CAAC,IAAD,EAAO,GAAP,EAAY,YAAZ,CARP,EAQkC,UAACC,GAAD,EAAMD,GAAN,EAAc;AAC5CP,cAAMS,IAAN,GAAaF,IAAIG,MAAJ,CAAWD,IAAxB;AACAT,cAAMW,IAAN,GAAad,mBAAmBU,IAAIG,MAAJ,CAAWC,IAA9B,CAAb;AACD,OAXH,EAYGC,IAZH,CAYQC,OAZR,CADF;AAAA,KADI,CAAN;;AAkBA,WACE,sBAAOZ,OAAOU,IAAd,EAAoBG,OAApB,CAA4Bd,MAAMW,IAAlC,KACAX,MAAMS,IAAN,KAAeR,OAAOQ,IAFxB;AAID,G","file":"updates.js","sourcesContent":["import moment from 'moment';\nimport simpleGit from 'simple-git';\nimport { paths } from '../../constants';\n\nconst gitDateToISOString = gitDate => moment(gitDate, 'YYYY-MM-DD HH:mm:ss Z');\n\nexport default async ({ repoPromise }) => {\n  const local = {};\n  const remote = {};\n\n  await repoPromise;\n  await new Promise(\n    resolve => (\n      simpleGit(paths.dirs.repo)\n        .fetch()\n        .checkout('origin/master')\n        .log(['-n', '1', '--date=iso'], (err, log) => {\n          remote.hash = log.latest.hash;\n          remote.date = gitDateToISOString(log.latest.date);\n        })\n        .checkout('master')\n        .log(['-n', '1', '--date=iso'], (err, log) => {\n          local.hash = log.latest.hash;\n          local.date = gitDateToISOString(log.latest.date);\n        })\n        .then(resolve)\n    ),\n  );\n\n  return (\n    moment(remote.date).isAfter(local.date) &&\n    local.hash !== remote.hash\n  );\n};\n"]}